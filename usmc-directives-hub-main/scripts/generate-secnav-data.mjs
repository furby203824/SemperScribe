#!/usr/bin/env node

/**
 * Generate SECNAV Directives Data File
 *
 * Real SECNAV instructions from DONI (Department of the Navy Issuances)
 * Source: https://www.secnav.navy.mil/doni/Directives/Forms/doniAllInstructions.aspx
 */

import { writeFile } from 'fs/promises';
import { dirname, join } from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const OUTPUT_FILE = join(__dirname, '../lib/secnav-data.js');

// Complete list of Active SECNAV Instructions from DONI
// Data extracted from: https://www.secnav.navy.mil/doni/Directives/Forms/doniAllInstructions.aspx
const SECNAV_INSTRUCTIONS = [
  // 2025 Instructions
  { id: '1000.17A', subject: 'MILITARY RESERVE EXCHANGE PROGRAM', date: '2025-04-03' },
  { id: '1401.1D', subject: 'OFFICER COMPETITIVE CATEGORIES FOR THE ACTIVE-DUTY LIST OF THE NAVY AND MARINE CORPS', date: '2025-04-08' },
  { id: '1531.2B', subject: 'UNITED STATES NAVAL ACADEMY MIDSHIPMEN DISENROLLMENT', date: '2025-04-24' },
  { id: '5430.7S', subject: 'ASSIGNMENT OF RESPONSIBILITIES AND AUTHORITIES IN THE OFFICE OF THE SECRETARY OF THE NAVY', date: '2025-10-03' },
  { id: '5200.35H', subject: 'CANCELLATION OF SECNAVINST 5200.35G DEPARTMENT OF THE NAVY MANAGERS INTERNAL CONTROL PROGRAM', date: '2025-06-12' },
  { id: '4440.34B', subject: 'GOVERNMENT FURNISHED PROPERTY, ACCOUNTABILITY, AND MANAGEMENT', date: '2025-07-22' },
  { id: '4440.35B', subject: 'OPERATING MATERIALS AND SUPPLIES - ACCOUNTABILITY AND MANAGEMENT', date: '2024-12-16' },
  { id: '7000.34', subject: 'ACQUISITION AND SUSTAINMENT PROGRAM COST ANALYSIS', date: '2025-09-12' },

  // 2024 Instructions
  { id: '2400.6', subject: 'DEPARTMENT OF THE NAVY SPECTRUM RELOCATION FUND PROGRAM', date: '2024-03-15' },
  { id: '2400.3C', subject: 'JOINT ELECTRONICS TYPE DESIGNATION AUTOMATED SYSTEM', date: '2024-10-03' },
  { id: '5030.3F', subject: 'SHIP NAMING, SPONSOR SELECTION, CREST DEVELOPMENT, KEEL LAYINGS, CHRISTENINGS, COMMISSIONINGS, AND DECOMMISSIONINGS', date: '2024-03-14' },
  { id: '4440.36A', subject: 'GENERAL EQUIPMENT – ACCOUNTABILITY AND MANAGEMENT', date: '2024-02-27' },
  { id: '5430.106', subject: 'DEPARTMENT OF THE NAVY RETIRED ACTIVITIES PROGRAM', date: '2024-03-18' },
  { id: '5720.44F', subject: 'DEPARTMENT OF THE NAVY PUBLIC AFFAIRS POLICY AND REGULATIONS', date: '2024-12-06' },

  // 2023 Instructions
  { id: '5000.42', subject: 'IDENTIFICATION OF MAJOR PROGRAM MANAGER EQUIVALENT BILLETS', date: '2023-04-14' },
  { id: '12250.7', subject: 'CIVILIAN FACULTY PAY SCHEDULE FOR THE UNITED STATES NAVAL ACADEMY, THE NAVAL WAR COLLEGE, THE NAVAL POST-GRADUATE SCHOOL, THE MARINE CORPS UNIVERSITY, AND THE UNITED STATES NAVAL COMMUNITY COLLEGE', date: '2023-05-10' },
  { id: '1300.20', subject: 'DEPARTMENT OF THE NAVY FOREIGN AREA OFFICER PROGRAMS', date: '2023-04-06' },
  { id: '2421.1', subject: 'COMMUNICATIONS SECURITY MONITORING', date: '2023-03-17' },
  { id: '4950.6', subject: 'ADDITIONAL POLICY AND PROCEDURES FOR INTERNATIONAL MILITARY STUDENT OFFICERS AND COUNTRY LIAISON OFFICERS IN FOREIGN MILITARY SALES CASES AND RELIGIOUS SUPPORT TO THE SAME', date: '2023-03-17' },
  { id: '5239.20A', subject: 'DEPARTMENT OF THE NAVY CYBERSPACE WORKFORCE QUALIFICATION AND MANAGEMENT PROGRAM', date: '2023-10-10' },
  { id: '5450.48A', subject: 'DEPARTMENT OF THE NAVY IMPLEMENTATION OF THE DEPARTMENT OF DEFENSE EXECUTIVE AGENT FOR MILITARY EXPLOSIVE ORDNANCE DISPOSAL TECHNOLOGY AND TRAINING', date: '2023-02-06' },
  { id: '5450.55', subject: 'THE NATIONAL NAVY RESERVE POLICY BOARD AND MARINE CORPS RESERVE POLICY BOARD', date: '2023-06-27' },
  { id: '5370.5C', subject: 'FUNDRAISING AND SOLICITATION IN SUPPORT OF THE NAVY-MARINE CORPS RELIEF SOCIETY', date: '2023-06-02' },
  { id: '6520.1A', subject: 'DIRECTORS OF PSYCHOLOGICAL HEALTH PROGRAM', date: '2023-06-22' },

  // 2022 Instructions
  { id: '1752.4C', subject: 'SEXUAL ASSAULT PREVENTION AND RESPONSE', date: '2022-01-14' },
  { id: '2400.2E', subject: 'ELECTROMAGNETIC ENVIRONMENTAL EFFECTS AND SPACE WEATHER EVENT PREPAREDNESS POLICY AND MANAGEMENT', date: '2022-09-09' },
  { id: '5000.2F', subject: 'DEPARTMENT OF THE NAVY IMPLEMENTATION OF THE DEFENSE ACQUISITION SYSTEM AND THE ADAPTIVE ACQUISITION FRAMEWORK', date: '2022-04-08' },
  { id: '5030.8D', subject: 'GENERAL GUIDANCE FOR THE CLASSIFICATION OF NAVAL VESSELS AND BATTLE FORCE SHIP COUNTING PROCEDURES', date: '2022-06-28' },
  { id: '5060.20A', subject: 'DEPARTMENT OF THE NAVY CONFERENCE MANAGEMENT PROGRAM', date: '2022-10-20' },
  { id: '4440.35A', subject: 'OPERATING MATERIALS AND SUPPLIES - ACCOUNTABILITY AND MANAGEMENT', date: '2022-10-21' },
  { id: '5500.36', subject: 'DEPARTMENT OF THE NAVY PHYSICAL SECURITY PROGRAM', date: '2022-02-22' },
  { id: '5800.13F', subject: 'DEPARTMENT OF THE NAVY LAW OF WAR PROGRAM', date: '2022-05-19' },
  { id: '4000.38B', subject: 'NAVAL LOGISTICS INTEGRATION', date: '2022-08-04' },
  { id: '5311.1', subject: 'DEPARTMENT OF THE NAVY ACQUISITION EXCELLENCE AWARDS PROGRAM', date: '2022-12-07' },
  { id: '1730.9A', subject: 'CONFIDENTIAL COMMUNICATIONS TO CHAPLAINS', date: '2022-10-31' },
  { id: '7000.28', subject: 'DEPARTMENT OF THE NAVY NUCLEAR DETERRENCE MISSION RESPONSIBILITIES AND AUTHORITIES', date: '2022-06-28' },
  { id: '3890.3', subject: '(U) OPEN SOURCE INTELLIGENCE', date: '2022-03-24' },

  // 2021 Instructions
  { id: '1420.3', subject: 'DEPARTMENT OF THE NAVY ENLISTED TO OFFICER COMMISSIONING PROGRAMS', date: '2021-05-10' },
  { id: '1740.5A', subject: 'EXCEPTIONAL FAMILY MEMBER PROGRAM', date: '2019-04-29' },
  { id: '3502.4C', subject: 'EXERCISE OF MILITARY AUTHORITY', date: '2021-04-05' },
  { id: '4001.2K', subject: 'VENDING FACILITY PROGRAM FOR THE BLIND ON FEDERAL PROPERTY', date: '2021-03-26' },
  { id: '5216.5E', subject: 'DEPARTMENT OF THE NAVY CORRESPONDENCE MANUAL', date: '2021-09-14' },
  { id: '5500.32', subject: 'CRITICAL INFRASTRUCTURE PROTECTION', date: '2021-07-22' },
  { id: '5720.44E', subject: 'PUBLIC AFFAIRS POLICY AND REGULATIONS', date: '2021-11-30' },
  { id: '5100.10L', subject: 'DEPARTMENT OF THE NAVY SAFETY PROGRAM', date: '2021-04-09' },
  { id: '7220.88A', subject: 'CIVILIAN PREMIUM PAY', date: '2021-03-25' },
  { id: '11011.36', subject: 'INTEGRATED NATURAL RESOURCES MANAGEMENT PLAN', date: '2021-10-07' },
  { id: '1770.4', subject: 'OPERATION OF MORALE, WELFARE, AND RECREATION ACTIVITIES', date: '2021-03-26' },
  { id: '3860.2B', subject: 'GUIDANCE FOR THE DOMESTIC USE OF UNMANNED AIRCRAFT SYSTEMS IN UNITED STATES NATIONAL AIRSPACE', date: '2021-04-27' },
  { id: '3850.2D', subject: 'DEPARTMENT OF THE NAVY MISSION ASSURANCE PROGRAM', date: '2021-01-04' },
  { id: '5000.43', subject: 'OVERSIGHT OF INTELLIGENCE ACTIVITIES, INTELLIGENCE-RELATED ACTIVITIES, SPECIAL ACCESS PROGRAMS, AND SENSITIVE ACTIVITIES WITHIN THE DEPARTMENT OF THE NAVY', date: '2021-01-19' },
  { id: '5000.44', subject: 'DEPARTMENT OF THE NAVY RESEARCH AND DEVELOPMENT, ACQUISITION, ASSOCIATED LIFE-CYCLE MANAGEMENT, AND SUSTAINMENT RESPONSIBILITIES AND ACCOUNTABILITY', date: '2021-01-19' },
  { id: '4950.4B', subject: 'JOINT SECURITY COOPERATION EDUCATION AND TRAINING', date: '2011-01-03' },
  { id: '5450.4K', subject: 'GOVERNANCE OF THE DEPARTMENT OF THE NAVYS OFFICE OF SMALL BUSINESS PROGRAMS, SMALL BUSINESS INNOVATION RESEARCH, AND SMALL BUSINESS TECHNOLOGY TRANSFER PROGRAMS', date: '2021-03-24' },
  { id: '5820.9', subject: 'PUBLICATION OF DEPARTMENT OF THE NAVY DIRECTIVES AND OTHER DOCUMENTS IN THE FEDERAL REGISTER', date: '2021-06-08' },
  { id: '5870.4A', subject: 'UNITED SERVICE ORGANIZATIONS, INC.', date: '2021-04-07' },
  { id: '7042.7M', subject: 'ESTABLISHMENT, MANAGEMENT, AND CONTROL OF THE FISHER HOUSE PROGRAM', date: '2021-05-06' },
  { id: '7043.5C', subject: 'NONAPPROPRIATED FUND PROCUREMENT POLICY', date: '2021-05-03' },
  { id: '7043.6', subject: 'DEPARTMENT OF THE NAVY POLICY FOR THE OPERATION AND MANAGEMENT OF THE NONAPPROPRIATED FUND PURCHASE CARD PROGRAM', date: '2021-03-26' },
  { id: '7600.2', subject: 'NAVAL VISIBILITY AND MANAGEMENT OF OPERATING AND SUPPORT COSTS PROGRAM DATA COLLECTION', date: '2021-01-26' },
  { id: '7600.3', subject: 'THE PLANNING, PROGRAMMING, BUDGETING, AND EXECUTION PROCESS', date: '2021-08-26' },
  { id: '1412.10', subject: 'NAVY ACTIVE DUTY DELAY FOR SPECIALISTS PROGRAM', date: '2021-09-23' },

  // 2020 Instructions
  { id: '1401.3C', subject: 'LEAVE AND LIBERTY POLICY AND ADMINISTRATION', date: '2020-03-15' },
  { id: '1640.10C', subject: 'CORRECTIONS MANUAL', date: '2020-06-18' },
  { id: '1754.8', subject: 'FAMILY ADVOCACY PROGRAM (FAP)', date: '2020-11-20' },
  { id: '3300.1D', subject: 'NAVAL INTELLIGENCE ACTIVITIES', date: '2020-05-12' },
  { id: '5210.11F', subject: 'DEPARTMENT OF THE NAVY PRIVACY PROGRAM', date: '2020-10-05' },
  { id: '5370.7D', subject: 'STANDARDS OF CONDUCT', date: '2020-02-27' },
  { id: '5510.30C', subject: 'DEPARTMENT OF THE NAVY PERSONNEL SECURITY PROGRAM', date: '2020-04-09' },
  { id: '5820.8A', subject: 'RELEASE OF OFFICIAL INFORMATION IN LITIGATION', date: '2020-09-11' },
  { id: '7000.27E', subject: 'FINANCIAL MANAGEMENT POLICY MANUAL', date: '2020-07-14' },
  { id: '11010.9D', subject: 'SHORE INSTALLATION MANAGEMENT', date: '2020-12-16' },
  { id: '12410.25C', subject: 'CIVILIAN TRAINING AND DEVELOPMENT', date: '2020-01-08' },
  { id: '5100.13E', subject: 'NAVY AND MARINE CORPS TOBACCO POLICY', date: '2020-12-02' },
  { id: '5210.14E', subject: 'SECRETARY OF THE NAVY DIRECTIVES POLICY', date: '2020-08-10' },
  { id: '5350.15B', subject: 'DRUG EDUCATION FOR YOUTH PROGRAM', date: '2020-12-02' },
  { id: '5510.36C', subject: 'DEPARTMENT OF THE NAVY PERSONNEL SECURITY PROGRAM', date: '2020-01-24' },
  { id: '5500.33A', subject: 'SECURITY PROFESSIONAL EDUCATION DEVELOPMENT PROGRAM', date: '2020-09-18' },
  { id: '5730.1', subject: 'CONGRESSIONAL NOTIFICATON AND PUBLIC ANNOUNCEMENT PROCEDURES CONCERNING BASE CLOSURES, CONTRACT AWARDS AND OTHER ACTIONS HAVING SIGNIFICANT ECONOMIC OR PERSONNEL IMPACT', date: '2020-01-02' },
  { id: '3870.4B', subject: 'INTELLIGENCE OVERSIGHT WITHIN THE DEPARTMENT OF THE NAVY', date: '2020-01-02' },
  { id: '5803.1', subject: 'MILITARY WHISTLEBLOWER PROTECTION', date: '2020-02-28' },
  { id: '5312.11', subject: 'DEPARTMENT OF THE NAVY OVERSEAS SCREENING PROGRAM', date: '2020-02-26' },
  { id: '5870.1A', subject: 'IMPLEMENTATION OF, AND COMPLIANCE WITH, ARMS CONTROL AGREEMENTS', date: '2018-08-28' },
  { id: '5580.3B', subject: 'MILITARY PERSONNEL EXCHANGE PROGRAM DEPLOYMENTS', date: '2020-12-07' },
  { id: '7041.3', subject: 'USE OF OFFICIAL REPRESENTATION FUNDS', date: '2020-06-30' },
  { id: '7041.4', subject: 'GUIDELINES FOR THE USE OF EMERGENCY AND EXTRAORDINARY EXPENSE FUNDING OTHER THAN OFFICIAL REPRESENTATION FUNDS', date: '2020-06-30' },
  { id: '5580.1B', subject: 'DEPARTMENT OF THE NAVY CLEMENCY AND PAROLE SYSTEMS', date: '2020-03-02' },
  { id: '4102.2', subject: 'JOINT REGULATION GOVERNING THE USE AND APPLICATION OF UNIFORM SOURCE, MAINTENANCE, AND RECOVERABILITY CODES', date: '2020-08-29' },

  // 2019 Instructions
  { id: '1000.10B', subject: 'DEPARTMENT OF THE NAVY POLICY ON PARENTHOOD AND PREGNANCY', date: '2019-01-16' },
  { id: '1000.7G', subject: 'INTERSERVICE TRANSFER OF OFFICERS', date: '2019-01-23' },
  { id: '1000.9B F', subject: 'CODE OF CONDUCT FOR MEMBERS OF THE ARMED FORCES OF THE UNITED STATES', date: '2019-04-12' },
  { id: '1000.15', subject: 'MANAGEMENT AND MOBILIZATION OF THE STANDBY RESERVE', date: '2019-01-24' },
  { id: '1000.18', subject: 'DEPARTMENT OF THE NAVY END STRENGTH MANAGEMENT', date: '2019-05-01' },
  { id: '11010.14B', subject: 'DEPARTMENT OF THE NAVY POLICY FOR CONSULTATION WITH FEDERALLY RECOGNIZED INDIAN TRIBES, ALASKA NATIVE TRIBAL ENTITIES, AND NATIVE HAWAIIAN ORGANIZATIONS', date: '2019-01-18' },
  { id: '11011.27D', subject: 'ACQUISITION, MANAGEMENT, AND DISPOSAL OF REAL PROPERTY AND REAL PROPERTY INTERESTS BY THE DEPARTMENT OF THE NAVY', date: '2019-06-26' },
  { id: '11011.42', subject: 'VICE PRESIDENTS RESIDENCE', date: '2019-02-26' },
  { id: '11011.46A', subject: 'GENERAL AND FLAG OFFICERS QUARTERS', date: '2019-05-23' },
  { id: '11260.2', subject: 'DEPARTMENT OF THE NAVY WEIGHT HANDLING PROGRAM FOR SHORE ACTIVITIES', date: '2019-03-26' },
  { id: '12250.1B', subject: 'CIVILIAN HUMAN RESOURCES MANAGEMENT IN THE DEPARTMENT OF THE NAVY', date: '2019-01-04' },
  { id: '12271.1', subject: 'DEPARTMENT OF THE NAVY TELEWORK POLICY', date: '2019-02-11' },
  { id: '12430.3A', subject: 'CIVILIAN HUMAN CAPITAL MANAGEMENT ASSESSMENT PROGRAM', date: '2019-02-22' },
  { id: '12510.1', subject: 'CIVILIAN EMPLOYEE TRAINING AND CAREER DEVELOPMENT', date: '2019-05-21' },
  { id: '1412.1D', subject: 'OFFICER COMPETITIVE CATEGORIES FOR THE ACTIVE DUTY LIST OF THE NAVY AND MARINE CORPS', date: '2019-04-05' },
  { id: '1416.1A', subject: 'CONSIDERATION OF ADVERSE INFORMATION BY GENERAL AND FLAG OFFICER PROMOTION SELECTION BOARDS', date: '2019-04-30' },
  { id: '1420.1C', subject: 'SPECIAL SELECTION BOARDS, SUPPLEMENTAL ALL-FULLY-QUALIFIED-OFFICERS LISTS, AND SPECIAL BOARDS', date: '2019-04-29' },
  { id: '1426.1', subject: 'MARINE CORPS WARRANT OFFICER PROMOTION AND CONTINUATION AND LIMITED DUTY OFFICER CONTINUATION PROCEDURES', date: '2019-06-27' },
  { id: '1427.2B', subject: 'PROMOTION OF OFFICERS TO THE GRADE OF LIEUTENANT (JUNIOR GRADE) IN THE NAVY AND TO THE GRADE OF FIRST LIEUTENANT IN THE MARINE CORPS', date: '2019-04-15' },
  { id: '1427.3A', subject: 'REGULATIONS TO GOVERN THE PROMOTION AND CONTINUATION OF CHIEF WARRANT OFFICERS AND THE CONTINUATION OF LIMITED DUTY OFFICERS SERVING ON THE ACTIVE DUTY LIST AND RESERVE ACTIVE STATUS LIST IN THE U.S. NAVY', date: '2019-04-15' },
  { id: '1412.6', subject: 'LAW EDUCATION PROGRAM', date: '2019-01-22' },
  { id: '1524.2C', subject: 'POLICIES CONCERNING THE NAVAL POSTGRADUATE SCHOOL', date: '2019-04-29' },
  { id: '1640.9D', subject: 'DEPARTMENT OF THE NAVY CORRECTIONS PROGRAM', date: '2019-05-15' },
  { id: '1730.7E', subject: 'RELIGIOUS MINISTRY WITHIN THE DEPARTMENT OF THE NAVY', date: '2019-03-11' },
  { id: '1740.3B', subject: 'SOLICITATION AND CONDUCT OF PERSONAL COMMERCIAL AFFAIRS ON DEPARTMENT OF THE NAVY INSTALLATIONS', date: '2019-06-18' },
  { id: '1740.4B', subject: 'DEPARTMENT OF THE NAVY PERSONAL FINANCIAL MANAGEMENT (PFM) EDUCATION, TRAINING, AND COUNSELING PROGRAM', date: '2019-04-23' },
  { id: '1754.5B', subject: 'DEPARTMENT OF THE NAVY RECOVERY COORDINATION PROGRAMS', date: '2019-06-26' },
  { id: '1820.1', subject: 'SECRETARY OF THE NAVY TRAUMATIC INJURY SERVICE MEMBERS GROUP LIFE INSURANCE IMPLEMENTATION GUIDANCE AND APPEALS PROCESS', date: '2019-02-11' },
  { id: '1820.2', subject: 'POLICY AND PROCEDURES FOR RESERVE COMPONENT MEMBER SERVICE BEYOND 16 YEARS OF ACTIVE DUTY SERVICE', date: '2019-03-28' },
  { id: '1850.4F', subject: 'DEPARTMENT OF THE NAVY DISABILITY EVALUATION SYSTEM', date: '2019-06-27' },
  { id: '1920.6D', subject: 'CONTINUATION ON ACTIVE DUTY OF REGULAR COMMISSIONED OFFICERS AND RESERVE OFFICERS ON THE RESERVE ACTIVE STATUS LIST IN THE NAVY AND MARINE CORPS', date: '2019-01-22' },
  { id: '1920.7A', subject: 'SELECTIVE RETIREMENT, SELECTIVE EARLY RETIREMENT, SELECTIVE EARLY REMOVAL, AND SELECTIVE EARLY DISCHARGE OF NAVY AND MARINE CORPS COMMISSIONED OFFICERS', date: '2019-05-20' },
  { id: '2400.4D', subject: 'ELECTROMAGNETIC SPECTRUM POLICY AND MANAGEMENT', date: '2019-05-20' },
  { id: '3440.2', subject: 'DEPARTMENT OF THE NAVY POLICY FOR CONTINUITY OF OPERATIONS PROGRAMS', date: '2019-05-01' },
  { id: '3800.3', subject: 'OPERATIONS SECURITY', date: '2019-05-09' },
  { id: '3820.5', subject: 'DEPARTMENT OF THE NAVY ANTITERRORISM PROGRAM', date: '2018-08-13' },
  { id: '3893.1', subject: 'TECHNICAL SURVEILLANCE COUNTERMEASURES PROGRAM', date: '2019-05-29' },
  { id: '3900.40D', subject: 'STANDARD FORMAT REQUIREMENTS FOR SCIENTIFIC AND TECHNICAL REPORTS', date: '2019-05-29' },
  { id: '3960.4', subject: 'NAVAL SCIENCE, TECHNOLOGY, ENGINEERING, AND MATHEMATICS POLICY AND COORDINATION', date: '2019-05-13' },
  { id: '4000.35D', subject: 'DEPARTMENT OF THE NAVY ACQUISITION INTEGRITY PROGRAM', date: '2019-02-14' },
  { id: '4000.37', subject: 'ACCEPTANCE OF GIFTS', date: '2018-05-07' },
  { id: '4101.2', subject: 'INDEPENDENT LOGISTICS ASSESSMENT AND CERTIFICATION REQUIREMENTS', date: '2018-03-12' },
  { id: '4120.27A', subject: 'IMPLEMENTATION OF THE DEFENSE STANDARDIZATION PROGRAM IN THE DEPARTMENT OF THE NAVY', date: '2019-03-29' },
  { id: '4200.36E', subject: 'CONTRACTOR LABOR RELATIONS', date: '2019-06-10' },
  { id: '4355.1', subject: 'DEPARTMENT OF THE NAVY FOOD SERVICE PROGRAM', date: '2020-08-25' },
  { id: '4440.35', subject: 'NAVY HAZARDOUS MATERIAL CONTROL AND MANAGEMENT', date: '2019-04-30' },
  { id: '4855.3B', subject: 'PRODUCT DATA REPORTING AND EVALUATION PROGRAM', date: '2018-12-21' },
  { id: '4900.50', subject: 'TECHNOLOGY TRANSFER AND SECURITY ASSISTANCE REVIEW BOARD', date: '2019-04-26' },
  { id: '4900.51', subject: 'TRANSFER OF U.S NAVAL VESSELS TO FOREIGN GOVERMENTS AND INTERNATIONAL ORGANIZATIONS', date: '2019-05-09' },
  { id: '4900.52', subject: 'POLICY AND PROCEDURES FOR SYSTEM SUPPORT BUY OUT', date: '2019-03-29' },
  { id: '5030.8C', subject: 'DEPARTMENT OF THE NAVY RECORDS MANAGEMENT PROGRAM', date: '2019-03-29' },
  { id: '5211.5F', subject: 'DEPARTMENT OF THE NAVY PRIVACY PROGRAM', date: '2019-05-20' },
  { id: '5213.1', subject: 'DEPARTMENT OF THE NAVY FORMS MANAGEMENT PROGRAM', date: '2019-10-18' },
  { id: '5214.1', subject: 'DEPARTMENT OF THE NAVY INFORMATION MANAGEMENT CONTROL PROGRAM', date: '2019-10-18' },
  { id: '5239.3C', subject: 'DEPARTMENT OF THE NAVY COMPUTER NETWORK INCIDENT RESPONSE AND REPORTING REQUIREMENTS', date: '2019-09-10' },
  { id: '5239.4', subject: 'DEPARTMENT OF THE NAVY DIGITAL SIGNATURE POLICY', date: '2019-07-22' },
  { id: '5300.26F', subject: 'DEPARTMENT OF THE NAVY CIVILIAN HUMAN RESOURCES MANUAL', date: '2019-12-03' },
  { id: '5400.15C', subject: 'INSPECTIONS WITHIN THE DEPARTMENT OF THE NAVY', date: '2019-10-31' },
  { id: '5061.17', subject: 'ZACHARY AND ELIZABETH FISHER DISTINGUISHED CIVILIAN HUMANITARIAN AWARD', date: '2019-12-05' },
  { id: '5061.18', subject: 'CAPTAIN ROBERT DEXTER CONRAD AWARD FOR SCIENTIFIC ACHIEVEMENT', date: '2019-05-29' },
  { id: '5090.8B', subject: 'POLICY FOR ENVIRONMENTAL PROTECTION, NATURAL RESOURCES, AND CULTURAL RESOURCES PROGRAMS', date: '2018-10-18' },
  { id: '5100.25A', subject: 'DEPARTMENT OF THE NAVY LASER PROTECTION PROGRAM', date: '2019-03-15' },
  { id: '5211.5F', subject: 'DEPARTMENT OF THE NAVY POLICY FOR DISCLOSURE OF CLASSIFIED MILITARY INFORMATION', date: '2018-07-20' },
  { id: '5450.4J', subject: 'ORGANIC DEPARTMENT OF THE NAVY PROCUREMENT SYSTEM OVERSIGHT AND MANAGEMENT', date: '2019-05-14' },
  { id: '5500.37', subject: 'ARMING AND THE USE OF FORCE', date: '2019-05-20' },
  { id: '5500.38', subject: 'DEPARTMENT OF THE NAVY SECURITY ENTERPRISE', date: '2019-06-14' },
  { id: '5510.34B', subject: 'DISCLOSURE OF CLASSIFIED MILITARY INFORMATION AND CONTROLLED UNCLASSIFIED INFORMATION TO FOREIGN GOVERNMENTS, INTERNATIONAL ORGANIZATIONS, AND FOREIGN REPRESENTATIVES', date: '2019-03-11' },
  { id: '5510.35B', subject: 'DEPARTMENT OF THE NAVY NUCLEAR WEAPONS PERSONNEL RELIABILITY PROGRAM', date: '2019-07-31' },
  { id: '5510.36B', subject: 'DEPARTMENT OF THE NAVY INFORMATION SECURITY PROGRAM', date: '2019-07-12' },
  { id: '5510.37', subject: 'DEPARTMENT OF THE NAVY INSIDER THREAT PROGRAM', date: '2019-10-28' },
  { id: '5500.35A', subject: 'SECURITY FORCE EMPLOYMENT AND OPERATIONS', date: '2019-05-20' },
  { id: '5580.2', subject: 'INTERNATIONAL AGREEMENTS AND ARRANGEMENTS', date: '2019-07-31' },
  { id: '5580.5', subject: 'COMPLIANCE WITH INTERNATIONAL TELECOMMUNICATION UNION RADIO REGULATIONS', date: '2019-12-05' },
  { id: '5720.42G', subject: 'DEPARTMENT OF THE NAVY FREEDOM OF INFORMATION ACT PROGRAM', date: '2019-01-15' },
  { id: '5800.13E', subject: 'DEPARTMENT OF THE NAVY LAW OF ARMED CONFLICT PROGRAM', date: '2019-03-06' },
  { id: '5000.45', subject: 'DEPARTMENT OF THE NAVY SPACE POLICY', date: '2019-07-01' },
  { id: '5450.5', subject: 'SECRETARY OF THE NAVY COUNCIL OF REVIEW BOARDS', date: '2019-05-13' },
  { id: '5450.40', subject: 'DEPARTMENT OF THE NAVY BUSINESS OPERATIONS MANAGEMENT COUNCIL', date: '2019-07-31' },
  { id: '5450.47', subject: 'MISSION AND FUNCTIONS OF THE NAVAL CRIMINAL INVESTIGATIVE SERVICE', date: '2019-06-19' },
  { id: '5430.57G', subject: 'THE GENERAL COUNSEL OF THE NAVY; ASSIGNMENT OF RESPONSIBILITIES', date: '2019-03-26' },
  { id: '5430.25E', subject: 'RESPONSIBILITY OF THE JUDGE ADVOCATE GENERAL OF THE NAVY AND THE STAFF JUDGE ADVOCATE TO THE COMMANDANT OF THE MARINE CORPS FOR SUPERVISION AND PROVISION OF CERTAIN LEGAL SERVICES', date: '2019-05-13' },
  { id: '5430.91', subject: 'MISSION AND FUNCTIONS OF THE NAVAL INSPECTOR GENERAL', date: '2019-12-30' },
  { id: '5430.103', subject: 'DEPARTMENT OF THE NAVY OVERSEAS FORCE STRUCTURE CHANGE AND HOST-NATION NOTIFICATION PROCEDURES', date: '2019-06-14' },
  { id: '5450.46', subject: 'PRESCRIBING CHANNELS OF RESPONSIBILITY FOR THE MILITARY SEALIFT COMMAND', date: '2019-03-14' },
  { id: '5500.39', subject: 'DEPARTMENT OF THE NAVY COMBATING TRAFFICKING IN PERSONS POLICY', date: '2018-12-13' },
  { id: '5726.1', subject: 'CONGRESSIONAL NOTIFICATION OF INTELLIGENCE ACTIVITIES, INTELLIGENCE-RELATED ACTIVITIES, SPECIAL ACCESS PROGRAMS, AND COVERT ACTIONS WITHIN THE DEPARTMENT OF THE NAVY', date: '2019-05-02' },
  { id: '5801.1', subject: 'INVESTIGATION OF ALLEGATIONS MADE AGAINST SENIOR OFFICIALS OF THE DEPARTMENT OF THE NAVY', date: '2019-12-17' },
  { id: '5800.16', subject: 'ALTERNATIVE DISPUTE RESOLUTION POLICY AND MISSION OF THE DEPARTMENT OF THE NAVY ALTERNATIVE DISPUTE RESOLUTION PROGRAM OFFICE', date: '2019-05-13' },
  { id: '5830.1', subject: 'DOMESTIC TECHNOLOGY TRANSFER', date: '2019-01-22' },
  { id: '5870.3', subject: 'ASYLUM AND TEMPORARY REFUGE', date: '2019-05-01' },
  { id: '6200.2A', subject: 'PERIODIC HEALTH ASSESSMENT FOR INDIVIDUAL MEDICAL READINESS', date: '2019-06-14' },
  { id: '6410.1', subject: 'UTILIZATION OF NAVAL FLIGHT SURGEONS, AEROSPACE MEDICINE PHYSICIAN ASSISTANTS, AVIATION MEDICAL EXAMINERS, AEROSPACE MEDICINE TECHNICIANS, AND SENIOR REGIONAL FLIGHT SURGEONS', date: '2019-04-05' },
  { id: '3501.1', subject: 'DEPARTMENT OF THE NAVY READINESS REPORTING SYSTEM', date: '2019-11-28' },
  { id: '5030.6D', subject: 'DEPARTMENT OF THE NAVY MODELING, SIMULATION, VERIFICATION, VALIDATION, AND ACCREDITATION MANAGEMENT', date: '2019-03-07' },
  { id: '4000.39', subject: 'SECRETARY OF THE NAVY ENERGY EXCELLENCE AWARDS PROGRAM', date: '2019-03-15' },
  { id: '3970.4', subject: 'DEPARTMENT OF THE NAVY CULTURAL RESOURCES PROGRAM', date: '2019-04-16' },
  { id: '7320.10A', subject: 'DEPARTMENT OF THE NAVY PERSONAL PROPERTY CLAIMS', date: '2019-08-01' },
  { id: '5802.1', subject: 'DEPARTMENT OF THE NAVY HOTLINE PROGRAM', date: '2019-11-05' },

  // 2018 and Earlier Instructions (Active)
  { id: '1412.9', subject: 'OVERSEAS AREA SCREENING CRITERIA', date: '2018-08-22' },
  { id: '1650.1J', subject: 'NAVY AND MARINE CORPS AWARDS MANUAL', date: '2019-08-15' },
  { id: '1730.9', subject: 'CONFIDENTIAL COMMUNICATIONS TO CHAPLAINS', date: '2018-12-05' },
  { id: '1141.3', subject: 'DESIGNATION OF OFFICERS OF THE REGULAR MARINE CORPS AND MARINE CORPS RESERVE AS MARINE CORPS JUDGE ADVOCATES', date: '2018-10-10' },
  { id: '12300.7', subject: 'NATIONAL CAPITAL REGION EXECUTIVE TRANSPORTATION AND BUS SERVICE', date: '2018-11-16' },
  { id: '12335.1A', subject: 'NAVY TOTAL FORCE MANPOWER POLICIES AND PROCEDURES', date: '2015-06-24' },
  { id: '12430.2D', subject: 'MERIT STAFFING, PLACEMENT, AND EMPLOYMENT', date: '2018-12-21' },
  { id: '12250.4A', subject: 'CIVILIAN EMPLOYEE ASSISTANCE PROGRAM', date: '2019-11-13' },
  { id: '12351.1', subject: 'WORKFORCE SHAPING', date: '2012-01-05' },
  { id: '12550.1A', subject: 'CLASSIFICATION AND POSITION MANAGEMENT', date: '2018-12-20' },
  { id: '12610.1', subject: 'PAY ADMINISTRATION (GENERAL)', date: '2018-12-07' },
  { id: '12610.2A', subject: 'CREDIT FOR PRIOR NON-FEDERAL WORK EXPERIENCE AND CERTAIN MILITARY SERVICE FOR DETERMINING LEAVE ACCRUAL RATE', date: '2018-06-19' },
  { id: '12752.1', subject: 'DISCIPLINARY ACTIONS', date: '2017-11-06' },
  { id: '12771.1', subject: 'FEDERAL EMPLOYEES COMPENSATION ACT PROGRAM', date: '2019-01-24' },
  { id: '12920.1', subject: 'DEFENSE CIVILIAN INTELLIGENCE PERSONNEL SYSTEM', date: '2018-12-11' },
  { id: '12990.1', subject: 'ACTIVE DUTY SERVICE DETERMINATION FOR CIVILIAN OR CONTRACTUAL GROUPS', date: '2018-08-22' },
  { id: '1300.18', subject: 'NATIONAL SECURITY DECISION DIRECTIVE 38', date: '2019-02-06' },
  { id: '1300.19', subject: 'DEFENSE ATTACHE SERVICE', date: '2019-05-20' },
  { id: '1300.21', subject: 'STAFF CORPS OF THE NAVY', date: '2019-04-25' },
  { id: '1306.2', subject: 'USE OF ENLISTED AIDES ON PERSONAL STAFFS', date: '2018-09-11' },
  { id: '1320.1C', subject: 'SECRETARY OF THE NAVY TOURS WITH INDUSTRY PROGRAM', date: '2019-05-15' },
  { id: '1420.2B', subject: 'FLEET MARINE FORCE WARFARE OFFICER PROGRAM', date: '2018-10-30' },
  { id: '1427.1', subject: 'FROCKING OF COMMISSIONED OFFICERS', date: '2018-10-30' },
  { id: '1427.4', subject: 'TEMPORARY SPOT PROMOTION OF OFFICERS', date: '2019-12-23' },
  { id: '1524.1C', subject: 'POLICY AND ASSIGNMENT OF RESPONSIBILITIES FOR MIDSHIPMEN SUMMER TRAINING', date: '2018-11-02' },
  { id: '1531.1B', subject: 'UNITED STATES NAVAL ACADEMY CURRICULUM AND ADMISSIONS POLICY', date: '2018-11-27' },
  { id: '1542.1', subject: 'U.S. NAVY AND MARINE CORPS AVIATION SELECTION TEST BATTERY', date: '2018-12-27' },
  { id: '1560.3', subject: 'DEPARTMENT OF THE NAVY VOLUNTARY EDUCATION PROGRAM', date: '2018-10-18' },
  { id: '1730.7D', subject: 'CHAPLAIN ADVISEMENT AND LIAISON', date: '2018-08-28' },
  { id: '1860.1', subject: 'RETIREMENT OF THE ASSISTANT JUDGE ADVOCATE GENERAL OF THE NAVY', date: '2018-10-05' },
  { id: '2421.2B', subject: 'DEPARTMENT OF THE NAVY COMMUNICATIONS SECURITY MATERIAL PROGRAM IMPLEMENTATION', date: '2016-05-23' },
  { id: '2400.1D', subject: 'ELECTROMAGNETIC BATTLE SPACE', date: '2018-10-05' },
  { id: '3440.1', subject: 'CYBERSPACE POLICY AND ADMINISTRATION WITHIN THE DEPARTMENT OF THE NAVY', date: '2009-03-06' },
  { id: '3640.1', subject: 'AWARD OF MEDALS, TROPHIES, BADGES, AND SIMILAR HONORS IN RECOGNITION OF ACCOMPLISHMENTS', date: '2018-02-02' },
  { id: '3870.2', subject: 'NATIONAL CENTER FOR MEDICAL INTELLIGENCE (NCMI)', date: '2018-12-21' },
  { id: '3891.1B', subject: 'DEPARTMENT OF THE NAVY COUNTERINTELLIGENCE', date: '2017-01-03' },
  { id: '3900.39D', subject: 'HUMAN RESEARCH PROTECTION PROGRAM', date: '2018-05-29' },
  { id: '3900.41', subject: 'ACQUISITION, TRANSPORT, CARE, AND TREATMENT OF NAVY MARINE MAMMALS', date: '2018-10-10' },
  { id: '4280.1B', subject: 'GOVERNMENT PROPERTY IN THE POSSESSION OF CONTRACTORS', date: '2018-09-07' },
  { id: '4855.5', subject: 'COUNTERFEIT MATERIEL PREVENTION', date: '2018-11-05' },
  { id: '5030.1', subject: 'OFFICIAL ESTABLISHMENT OF THE DEPARTMENT OF THE NAVY SEAL', date: '2018-04-24' },
  { id: '5090.6B', subject: 'ENVIRONMENTAL PLANNING FOR DEPARTMENT OF THE NAVY ACTIONS', date: '2018-10-09' },
  { id: '5090.7', subject: 'ACCESS TO SHIPS AND SHORE FACILITIES, AND RELEASE OF INFORMATION REGARDING NAVY OIL SPILLS', date: '2018-12-21' },
  { id: '5100.26', subject: 'DEPARTMENT OF THE NAVY GAS FREE ENGINEER CERTIFICATION AND RECERTIFICATION', date: '2018-04-18' },
  { id: '5100.27', subject: 'DEPARTMENT OF THE NAVY INSTALLATION AUTOMATED EXTERNAL DEFIBRILLATION (AED) PROGRAM', date: '2018-12-21' },
  { id: '5239.3B', subject: 'DEPARTMENT OF THE NAVY CYBERSECURITY POLICY', date: '2016-05-02' },
  { id: '5300.28B', subject: 'MANAGEMENT OF HUMAN IMMUNODEFICIENCY VIRUS, HEPATITIS B VIRUS, AND HEPATITIS C VIRUS INFECTION IN THE NAVY AND MARINE CORPS', date: '2018-12-27' },
  { id: '5312.1', subject: 'DEPARTMENT OF THE NAVY ACQUISITION WORKFORCE MANAGEMENT, OVERSIGHT, AND STEWARDSHIP', date: '2018-07-25' },
  { id: '5370.2E', subject: 'SELECTION OF DEPARTMENT OF THE NAVY MILITARY AND CIVILIAN PERSONNEL AND CONTRACTOR EMPLOYEES FOR ASSIGNMENT TO PRESIDENTIAL SUPPORT ACTIVITIES', date: '2019-01-15' },
  { id: '5370.4', subject: 'FUNDRAISING AND SOLICITATION OF MILITARY PERSONNEL AND CIVILIAN EMPLOYEES IN THE NATIONAL CAPITAL REGION', date: '2018-05-16' },
  { id: '5370.8', subject: 'DEPARTMENT OF THE NAVY CORE VALUES CHARTER AND ETHICS TRAINING', date: '2018-04-18' },
  { id: '5400.16', subject: 'HUMAN REMAINS ASSOCIATED WITH SUNKEN MILITARY CRAFT', date: '2018-07-11' },
  { id: '5430.27C', subject: 'COMMAND RELATIONSHIPS WHEN THE COAST GUARD IS OPERATING AS A SERVICE IN THE NAVY', date: '2018-06-19' },
  { id: '5430.92C', subject: 'ASSIGNMENT OF RESPONSIBILITIES TO COUNTERACT ACQUISITION FRAUD, WASTE, AND RELATED IMPROPRIETIES', date: '2018-06-11' },
  { id: '5430.101A', subject: 'MANAGEMENT OF THE NAVAL AIRCRAFT INVENTORY AND UNMANNED AIRCRAFT SYSTEMS', date: '2019-02-06' },
  { id: '5450.44A', subject: 'ESTABLISHMENT AND DISESTABLISHMENT OF SHORE (FIELD) ACTIVITIES, CHANGE TO HOMEPORT ASSIGNMENT, AND ASSIGNMENT AND DISTRIBUTION OF AUTHORITY AND RESPONSIBILITY IN THE DEPARTMENT OF NAVY', date: '2018-10-09' },
  { id: '5450.45', subject: 'MISSION, FUNCTIONS, AND TASKS OF THE DEPARTMENT OF THE NAVY SPECIAL ACCESS PROGRAM CENTRAL OFFICE', date: '2018-10-30' },
  { id: '5500.34', subject: 'PARKING FOR DON ACTIVITIES LOCATED ON THE PENTAGON RESERVATION', date: '2018-02-06' },
  { id: '5580.4', subject: 'NAVAL CRIMINAL INVESTIGATIVE SERVICE TIPS PROGRAM', date: '2018-09-25' },
  { id: '5870.2', subject: 'IMPLEMENTATION AND COMPLIANCE OF THE TREATY ON OPEN SKIES', date: '2018-12-20' },
  { id: '5870.4', subject: 'DEPARTMENT OF THE NAVY READINESS FOR CHALLENGE INSPECTIONS UNDER THE CHEMICAL WEAPONS CONVENTION', date: '2018-12-03' },
  { id: '5870.5', subject: 'DEPARTMENT OF THE NAVY IMPLEMENTATION OF, AND COMPLIANCE WITH, THE UNITED STATES-INTERNATIONAL ATOMIC ENERGY AGENCY INTEGRATED SAFEGUARDS AGREEMENTS', date: '2018-11-11' },
  { id: '5870.6', subject: 'DEPARTMENT OF THE NAVY IMPLEMENTATION OF, AND COMPLIANCE WITH, THE TREATY BETWEEN THE UNITED STATES OF AMERICA AND THE RUSSIAN FEDERATION ON MEASURES FOR FURTHER REDUCTION AND LIMITATION OF STRATEGIC OFFENSIVE ARMS', date: '2018-12-20' },
  { id: '5840.1', subject: 'INVENTIONS MADE BY DEPARTMENT OF THE NAVY EMPLOYEES', date: '2018-07-11' },
  { id: '5840.2', subject: 'DEPARTMENT OF THE NAVY TRADEMARK AND LICENSING PROGRAM', date: '2019-02-08' },
  { id: '7000.14', subject: 'DEPARTMENT OF DEFENSE FINANCIAL MANAGEMENT REGULATION', date: '2018-10-30' },
  { id: '7042.2', subject: 'AVIATION INCENTIVE PAYS AND BONUS PROGRAM', date: '2018-02-06' },
  { id: '7510.7F', subject: 'DEPARTMENT OF THE NAVY INTERNAL AUDIT', date: '2018-04-18' },
  { id: '11011.47A', subject: 'ENVIRONMENTAL PLANNING FOR DON ACTIONS', date: '2018-04-11' },
  { id: '5450.49', subject: 'DEPARTMENT OF THE NAVY SEXUAL ASSAULT PREVENTION AND RESPONSE OFFICE', date: '2018-06-05' }
];

/**
 * DONI Subcategory mappings
 * Based on actual DONI folder structure
 */
const SUBCATEGORY_MAP = {
  // 01000 Military Personnel Support
  '1000': '01-01 General Military Personnel Records',
  '1001': '01-01 General Military Personnel Records',
  '1100': '01-100 Officer Personnel',
  '1141': '01-100 Officer Personnel',
  '1300': '01-300 Military Personnel General Records',
  '1306': '01-300 Military Personnel General Records',
  '1320': '01-300 Military Personnel General Records',
  '1400': '01-400 Promotion and Advancement Programs',
  '1401': '01-400 Promotion and Advancement Programs',
  '1412': '01-400 Promotion and Advancement Programs',
  '1416': '01-400 Promotion and Advancement Programs',
  '1420': '01-400 Promotion and Advancement Programs',
  '1426': '01-400 Promotion and Advancement Programs',
  '1427': '01-400 Promotion and Advancement Programs',
  '1500': '01-500 Military Training and Education Services',
  '1524': '01-500 Military Training and Education Services',
  '1531': '01-500 Military Training and Education Services',
  '1542': '01-500 Military Training and Education Services',
  '1560': '01-500 Military Training and Education Services',
  '1600': '01-600 Military Correctional Services',
  '1640': '01-600 Military Correctional Services',
  '1650': '01-600 Military Awards Services',
  '1700': '01-700 Morale Welfare and Recreation',
  '1730': '01-700 Morale Welfare and Recreation',
  '1740': '01-700 Morale Welfare and Recreation',
  '1750': '01-750 Family Support Services',
  '1752': '01-750 Family Support Services',
  '1754': '01-750 Family Support Services',
  '1770': '01-700 Morale Welfare and Recreation',
  '1800': '01-800 Retirement Services',
  '1820': '01-800 Retirement Services',
  '1850': '01-800 Retirement Services',
  '1860': '01-800 Retirement Services',
  '1900': '01-900 Reserve Personnel',
  '1920': '01-900 Reserve Personnel',

  // 02000 Communications
  '2400': '02-400 Telecommunication Systems',
  '2421': '02-400 Telecommunication Systems',

  // 03000 Operations and Readiness
  '3300': '03-300 Intelligence',
  '3440': '03-400 Base Defense',
  '3500': '03-500 Readiness',
  '3501': '03-500 Readiness',
  '3502': '03-500 Readiness',
  '3640': '03-600 Military Awards',
  '3800': '03-800 Military Information Security',
  '3820': '03-800 Military Information Security',
  '3850': '03-800 Military Information Security',
  '3860': '03-800 Military Information Security',
  '3870': '03-800 Military Information Security',
  '3890': '03-800 Military Information Security',
  '3891': '03-800 Military Information Security',
  '3893': '03-800 Military Information Security',
  '3900': '03-900 Research and Development',
  '3960': '03-900 Research and Development',
  '3970': '03-900 Research and Development',

  // 04000 Logistical Support and Services
  '4000': '04-000 Logistics General',
  '4001': '04-000 Logistics General',
  '4100': '04-100 Industrial Production',
  '4101': '04-100 Industrial Production',
  '4102': '04-100 Industrial Production',
  '4120': '04-100 Industrial Production',
  '4200': '04-200 Procurement',
  '4280': '04-200 Procurement',
  '4355': '04-300 Food Service',
  '4440': '04-400 Material Management',
  '4720': '04-700 Transportation',
  '4855': '04-800 Product Assurance',
  '4900': '04-900 Transportation Services',
  '4950': '04-900 Transportation Services',

  // 05000 General Management Security and Safety Services
  '5000': '05-000 General Management Support',
  '5030': '05-000 General Management Support',
  '5060': '05-000 General Management Support',
  '5061': '05-000 General Management Support',
  '5090': '05-000 General Management Support',
  '5100': '05-100 Safety',
  '5200': '05-200 Management Program and Techniques Services',
  '5210': '05-200 Management Program and Techniques Services',
  '5211': '05-200 Management Program and Techniques Services',
  '5213': '05-200 Management Program and Techniques Services',
  '5214': '05-200 Management Program and Techniques Services',
  '5216': '05-200 Management Program and Techniques Services',
  '5239': '05-200 Management Program and Techniques Services',
  '5300': '05-300 Manpower and Personnel Management',
  '5311': '05-300 Manpower and Personnel Management',
  '5312': '05-300 Manpower and Personnel Management',
  '5350': '05-300 Manpower and Personnel Management',
  '5370': '05-300 Manpower and Personnel Management',
  '5400': '05-400 Organization and Functional Support Services',
  '5430': '05-400 Organization and Functional Support Services',
  '5450': '05-400 Organization and Functional Support Services',
  '5500': '05-500 Security',
  '5510': '05-500 Security',
  '5520': '05-500 Security',
  '5580': '05-500 Security',
  '5700': '05-700 Public Affairs and Information',
  '5720': '05-700 Public Affairs and Information',
  '5726': '05-700 Public Affairs and Information',
  '5730': '05-700 Public Affairs and Information',
  '5800': '05-800 Legal Services',
  '5801': '05-800 Legal Services',
  '5802': '05-800 Legal Services',
  '5803': '05-800 Legal Services',
  '5820': '05-800 Legal Services',
  '5830': '05-800 Legal Services',
  '5840': '05-800 Legal Services',
  '5870': '05-800 Legal Services',

  // 06000 Medicine and Dentistry
  '6000': '06-000 Medicine and Dentistry General',
  '6200': '06-200 Medical Services',
  '6410': '06-400 Aviation Medicine',
  '6420': '06-400 Aviation Medicine',
  '6520': '06-500 Psychology',

  // 07000 Financial Management
  '7000': '07-000 Financial Management General',
  '7041': '07-000 Financial Management General',
  '7042': '07-000 Financial Management General',
  '7043': '07-000 Financial Management General',
  '7220': '07-200 Pay and Allowances',
  '7320': '07-300 Personal Property Claims',
  '7510': '07-500 Auditing',
  '7600': '07-600 Budget',

  // 10000 DON Issuances
  '10000': '10000 General DON Issuances',

  // 11000 Facilities and Activities Ashore
  '11010': '11-000 Facilities General',
  '11011': '11-000 Facilities General',
  '11100': '11-100 Naval Regulations',
  '11101': '11-100 Naval Regulations',
  '11260': '11-200 Weight Handling',

  // 12000 Civilian Personnel
  '12250': '12-200 Civilian Personnel Administration',
  '12271': '12-200 Civilian Personnel Administration',
  '12300': '12-300 Employment and Placement',
  '12335': '12-300 Employment and Placement',
  '12351': '12-300 Employment and Placement',
  '12410': '12-400 Training',
  '12430': '12-400 Training',
  '12510': '12-500 Classification',
  '12550': '12-500 Classification',
  '12610': '12-600 Pay',
  '12752': '12-700 Discipline',
  '12771': '12-700 Discipline',
  '12920': '12-900 Defense Intelligence',
  '12990': '12-900 Defense Intelligence',
};

/**
 * Map instruction number to category and subcategory folders
 */
function getPathFolders(instNum) {
  const baseNum = instNum.split('.')[0];
  const prefix = parseInt(baseNum);

  // Determine main category
  let category;
  if (prefix >= 1000 && prefix < 2000) category = '01000 Military Personnel Support';
  else if (prefix >= 2000 && prefix < 3000) category = '02000 Communications';
  else if (prefix >= 3000 && prefix < 4000) category = '03000 Operations and Readiness';
  else if (prefix >= 4000 && prefix < 5000) category = '04000 Logistical Support and Services';
  else if (prefix >= 5000 && prefix < 6000) category = '05000 General Management Security and Safety Services';
  else if (prefix >= 6000 && prefix < 7000) category = '06000 Medicine and Dentistry';
  else if (prefix >= 7000 && prefix < 8000) category = '07000 Financial Management';
  else if (prefix >= 10000 && prefix < 11000) category = '10000 DON Issuances';
  else if (prefix >= 11000 && prefix < 12000) category = '11000 Facilities and Activities Ashore';
  else if (prefix >= 12000 && prefix < 13000) category = '12000 Civilian Personnel';
  else category = '05000 General Management Security and Safety Services';

  // Get subcategory from map
  const subcategory = SUBCATEGORY_MAP[baseNum] || null;

  return { category, subcategory };
}

/**
 * Build URL for a SECNAV instruction
 */
function buildUrl(instruction) {
  const baseUrl = 'https://www.secnav.navy.mil/doni';
  const { category, subcategory } = getPathFolders(instruction.id);

  // Build path with or without subcategory
  let path;
  if (subcategory) {
    path = `Directives/${encodeURIComponent(category)}/${encodeURIComponent(subcategory)}/${instruction.id}.pdf`;
  } else {
    path = `Directives/${encodeURIComponent(category)}/${instruction.id}.pdf`;
  }

  return `${baseUrl}/${path}`;
}

/**
 * Transform instructions to data format
 */
function transformInstructions() {
  return SECNAV_INSTRUCTIONS.map(inst => {
    const pubDate = new Date(inst.date).toISOString();
    return {
      id: `SECNAVINST ${inst.id}`,
      title: `SECNAVINST ${inst.id} - ${inst.subject}`,
      subject: inst.subject,
      link: buildUrl(inst),
      pubDate: pubDate,
      description: `Secretary of the Navy Instruction ${inst.id} - ${inst.subject}`,
      category: getPathFolders(inst.id).category.split(' ').slice(1).join(' '),
      effectiveDate: inst.date
    };
  });
}

/**
 * Generate JavaScript data file
 */
async function generateDataFile() {
  const directives = transformInstructions();
  directives.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));

  const timestamp = new Date().toISOString();
  const categories = [...new Set(directives.map(d => d.category))];

  const fileContent = `/**
 * SECNAV Directives Data
 *
 * Real SECNAV instructions from DONI (Department of the Navy Issuances)
 * Source: https://www.secnav.navy.mil/doni/Directives/Forms/doniAllInstructions.aspx
 * Generated: ${timestamp}
 * Total Records: ${directives.length}
 *
 * This file is automatically generated by scripts/generate-secnav-data.mjs
 * DO NOT EDIT MANUALLY
 */

// SECNAV directives data structure
const SECNAV_DIRECTIVES = ${JSON.stringify(directives, null, 2)};

// Metadata
const SECNAV_META = {
  sourceUrl: 'https://www.secnav.navy.mil/doni/Directives/Forms/doniAllInstructions.aspx',
  generatedAt: '${timestamp}',
  totalRecords: ${directives.length},
  categories: ${JSON.stringify(categories)},
  lastUpdate: '${timestamp}',
  note: 'Real SECNAV instructions from DONI'
};

// Export for use in application
if (typeof window !== 'undefined') {
  window.SECNAV_DIRECTIVES = SECNAV_DIRECTIVES;
  window.SECNAV_META = SECNAV_META;
}

// Also support module exports for testing
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    SECNAV_DIRECTIVES,
    SECNAV_META
  };
}
`;

  await writeFile(OUTPUT_FILE, fileContent, 'utf-8');
  console.log(`[SECNAV] Data file written to: ${OUTPUT_FILE}`);
  console.log(`[SECNAV] Total records: ${directives.length}`);
}

async function main() {
  console.log('[SECNAV] Generating SECNAV data from real instructions...');

  try {
    await generateDataFile();
    console.log('[SECNAV] ✓ Complete');
    process.exit(0);
  } catch (error) {
    console.error('[SECNAV] Fatal error:', error);
    process.exit(1);
  }
}

main();
